apply plugin: 'java-library'
apply plugin: 'biz.aQute.bnd.builder'

description = 'Trellis Event Serialization (jsonb)'

configurations {
    jsonb
}

ext {
    moduleName = 'org.trellisldp.event.jsonb'
    testModules = ['org.apache.commons.rdf.simple']
}

dependencies {
    api project(':trellis-api')
    api "jakarta.json.bind:jakarta.json.bind-api:$jsonbVersion"

    implementation project(':trellis-vocabulary')

    testImplementation "org.mockito:mockito-core:$mockitoVersion"
    testImplementation "org.apache.commons:commons-rdf-simple:$commonsRdfVersion"
    testImplementation "org.eclipse:yasson:$yassonVersion"

    jsonb "org.glassfish:jakarta.json:$glassfishJsonVersion"

    if (!project.sourceCompatibility.isJava11Compatible()) {
        testImplementation "org.glassfish:jakarta.json:$glassfishJsonVersion"
    }
}

if (project.sourceCompatibility.isJava11Compatible()) {
    compileTestJava {
        doFirst {
            classpath = files(configurations.jsonb)
        }
    }

    test {
        inputs.property("moduleName", moduleName)
        doFirst {
            classpath = files(configurations.jsonb)
        }
    }

}
